---
import type { MarkdownContent } from "astro";
import { getAuthor } from "src/authors";
import type { PageFrontmatter, SEO } from "src/types";

import AuthorInfo from "@/components/AuthorInfo";
import Utterances from "@/components/Utterances";

import BaseLayout from "./BaseLayout.astro";

export interface Props {
  content: MarkdownContent<PageFrontmatter>;
}

const { content } = Astro.props as Props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site);
const seo: SEO = {
  title: content.title,
  description: content.excerpt,
  openGraph: {
    title: content.title,
    type: "article",
    description: content.excerpt,
    url: canonicalURL.toString(),
    image: `${Astro.site?.href || ""}/images/banner.png`,
    article: {
      authors: [content.author],
      publishedTime: content.publication_date,
      modifiedTime: content.publication_date,
    },
  },
};

const author = getAuthor(content.author);
---

<BaseLayout seo={seo}>
  <article
    class="prose mx-auto my-10 px-4 dark:prose-invert xl:prose-xl md:my-20 md:px-0"
  >
    <slot />
    <hr />
    {author && <AuthorInfo author={author} />}
    <Utterances client:only="react" />
  </article>
</BaseLayout>
